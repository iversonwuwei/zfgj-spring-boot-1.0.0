<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dlfc.zfgj.mapper.AgtUsrCompLogInfoMapper">
	<resultMap id="BaseResultMap" type="com.dlfc.zfgj.entity.AgtUsrCompLogInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		<id column="ID" jdbcType="VARCHAR" property="id" />
		<result column="PINDEX" jdbcType="INTEGER" property="pindex" />
		<result column="EID" jdbcType="VARCHAR" property="eid" />
		<result column="USER_ID" jdbcType="VARCHAR" property="userId" />
		<result column="PID" jdbcType="VARCHAR" property="pid" />
		<result column="OFFICE_ID" jdbcType="VARCHAR" property="officeId" />
		<result column="COMPANY_ID" jdbcType="VARCHAR" property="companyId" />
		<result column="REJECT_REASON" jdbcType="VARCHAR" property="rejectReason" />
		<result column="STATUS" jdbcType="INTEGER" property="status" />
		<result column="CREATE_USER" jdbcType="VARCHAR" property="createUser" />
		<result column="CREATE_USER_IDENTITY" jdbcType="SMALLINT"
			property="createUserIdentity" />
		<result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
		<result column="MODIFY_USER" jdbcType="VARCHAR" property="modifyUser" />
		<result column="MODIFY_USER_IDENTITY" jdbcType="SMALLINT"
			property="modifyUserIdentity" />
		<result column="MODIFY_TIME" jdbcType="TIMESTAMP" property="modifyTime" />
		<result column="DELETE_FLG" jdbcType="SMALLINT" property="deleteFlg" />
		<result column="VERSION" jdbcType="INTEGER" property="version" />
	</resultMap>
	<sql id="Example_Where_Clause">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		<where>
			<foreach collection="oredCriteria" item="criteria" separator="or">
				<if test="criteria.valid">
					<trim prefix="(" prefixOverrides="and" suffix=")">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value}
									and
									#{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach close=")" collection="criterion.value" item="listItem"
										open="(" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Update_By_Example_Where_Clause">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		<where>
			<foreach collection="example.oredCriteria" item="criteria"
				separator="or">
				<if test="criteria.valid">
					<trim prefix="(" prefixOverrides="and" suffix=")">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value}
									and
									#{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach close=")" collection="criterion.value" item="listItem"
										open="(" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		ID, PINDEX, EID, USER_ID, PID, OFFICE_ID, COMPANY_ID, REJECT_REASON,
		STATUS, CREATE_USER,
		CREATE_USER_IDENTITY, CREATE_TIME, MODIFY_USER,
		MODIFY_USER_IDENTITY, MODIFY_TIME,
		DELETE_FLG, VERSION
	</sql>
	<select id="selectByExample" parameterType="com.dlfc.zfgj.entity.AgtUsrCompLogInfoExample"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		select
		<if test="distinct">
			distinct
		</if>
		<include refid="Base_Column_List" />
		from agt_usr_comp_log_info
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
		<if test="orderByClause != null">
			order by ${orderByClause}
		</if>
	</select>
	<select id="selectByPrimaryKey" parameterType="java.lang.String"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		select
		<include refid="Base_Column_List" />
		from agt_usr_comp_log_info
		where ID = #{id,jdbcType=VARCHAR}
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.String">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		delete from agt_usr_comp_log_info
		where ID = #{id,jdbcType=VARCHAR}
	</delete>
	<delete id="deleteByExample" parameterType="com.dlfc.zfgj.entity.AgtUsrCompLogInfoExample">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		delete from agt_usr_comp_log_info
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</delete>
	<insert id="insert" parameterType="com.dlfc.zfgj.entity.AgtUsrCompLogInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		insert into agt_usr_comp_log_info (ID, PINDEX, EID,
		USER_ID, PID,
		OFFICE_ID,
		COMPANY_ID, REJECT_REASON, STATUS,
		CREATE_USER,
		CREATE_USER_IDENTITY, CREATE_TIME,
		MODIFY_USER, MODIFY_USER_IDENTITY,
		MODIFY_TIME,
		DELETE_FLG, VERSION)
		values (#{id,jdbcType=VARCHAR},
		#{pindex,jdbcType=INTEGER},
		#{eid,jdbcType=VARCHAR},
		#{userId,jdbcType=VARCHAR}, #{pid,jdbcType=VARCHAR},
		#{officeId,jdbcType=VARCHAR},
		#{companyId,jdbcType=VARCHAR},
		#{rejectReason,jdbcType=VARCHAR},
		#{status,jdbcType=INTEGER},
		#{createUser,jdbcType=VARCHAR},
		#{createUserIdentity,jdbcType=SMALLINT},
		#{createTime,jdbcType=TIMESTAMP},
		#{modifyUser,jdbcType=VARCHAR},
		#{modifyUserIdentity,jdbcType=SMALLINT},
		#{modifyTime,jdbcType=TIMESTAMP},
		#{deleteFlg,jdbcType=SMALLINT},
		#{version,jdbcType=INTEGER})
	</insert>
	<insert id="insertSelective" parameterType="com.dlfc.zfgj.entity.AgtUsrCompLogInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		insert into agt_usr_comp_log_info
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				ID,
			</if>
			<if test="pindex != null">
				PINDEX,
			</if>
			<if test="eid != null">
				EID,
			</if>
			<if test="userId != null">
				USER_ID,
			</if>
			<if test="pid != null">
				PID,
			</if>
			<if test="officeId != null">
				OFFICE_ID,
			</if>
			<if test="companyId != null">
				COMPANY_ID,
			</if>
			<if test="rejectReason != null">
				REJECT_REASON,
			</if>
			<if test="status != null">
				STATUS,
			</if>
			<if test="createUser != null">
				CREATE_USER,
			</if>
			<if test="createUserIdentity != null">
				CREATE_USER_IDENTITY,
			</if>
			<if test="createTime != null">
				CREATE_TIME,
			</if>
			<if test="modifyUser != null">
				MODIFY_USER,
			</if>
			<if test="modifyUserIdentity != null">
				MODIFY_USER_IDENTITY,
			</if>
			<if test="modifyTime != null">
				MODIFY_TIME,
			</if>
			<if test="deleteFlg != null">
				DELETE_FLG,
			</if>
			<if test="version != null">
				VERSION,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=VARCHAR},
			</if>
			<if test="pindex != null">
				#{pindex,jdbcType=INTEGER},
			</if>
			<if test="eid != null">
				#{eid,jdbcType=VARCHAR},
			</if>
			<if test="userId != null">
				#{userId,jdbcType=VARCHAR},
			</if>
			<if test="pid != null">
				#{pid,jdbcType=VARCHAR},
			</if>
			<if test="officeId != null">
				#{officeId,jdbcType=VARCHAR},
			</if>
			<if test="companyId != null">
				#{companyId,jdbcType=VARCHAR},
			</if>
			<if test="rejectReason != null">
				#{rejectReason,jdbcType=VARCHAR},
			</if>
			<if test="status != null">
				#{status,jdbcType=INTEGER},
			</if>
			<if test="createUser != null">
				#{createUser,jdbcType=VARCHAR},
			</if>
			<if test="createUserIdentity != null">
				#{createUserIdentity,jdbcType=SMALLINT},
			</if>
			<if test="createTime != null">
				#{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="modifyUser != null">
				#{modifyUser,jdbcType=VARCHAR},
			</if>
			<if test="modifyUserIdentity != null">
				#{modifyUserIdentity,jdbcType=SMALLINT},
			</if>
			<if test="modifyTime != null">
				#{modifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="deleteFlg != null">
				#{deleteFlg,jdbcType=SMALLINT},
			</if>
			<if test="version != null">
				#{version,jdbcType=INTEGER},
			</if>
		</trim>
	</insert>
	<select id="countByExample" parameterType="com.dlfc.zfgj.entity.AgtUsrCompLogInfoExample"
		resultType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		select count(*) from agt_usr_comp_log_info
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</select>
	<update id="updateByExampleSelective" parameterType="map">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		update agt_usr_comp_log_info
		<set>
			<if test="record.id != null">
				ID = #{record.id,jdbcType=VARCHAR},
			</if>
			<if test="record.pindex != null">
				PINDEX = #{record.pindex,jdbcType=INTEGER},
			</if>
			<if test="record.eid != null">
				EID = #{record.eid,jdbcType=VARCHAR},
			</if>
			<if test="record.userId != null">
				USER_ID = #{record.userId,jdbcType=VARCHAR},
			</if>
			<if test="record.pid != null">
				PID = #{record.pid,jdbcType=VARCHAR},
			</if>
			<if test="record.officeId != null">
				OFFICE_ID = #{record.officeId,jdbcType=VARCHAR},
			</if>
			<if test="record.companyId != null">
				COMPANY_ID = #{record.companyId,jdbcType=VARCHAR},
			</if>
			<if test="record.rejectReason != null">
				REJECT_REASON = #{record.rejectReason,jdbcType=VARCHAR},
			</if>
			<if test="record.status != null">
				STATUS = #{record.status,jdbcType=INTEGER},
			</if>
			<if test="record.createUser != null">
				CREATE_USER = #{record.createUser,jdbcType=VARCHAR},
			</if>
			<if test="record.createUserIdentity != null">
				CREATE_USER_IDENTITY =
				#{record.createUserIdentity,jdbcType=SMALLINT},
			</if>
			<if test="record.createTime != null">
				CREATE_TIME = #{record.createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="record.modifyUser != null">
				MODIFY_USER = #{record.modifyUser,jdbcType=VARCHAR},
			</if>
			<if test="record.modifyUserIdentity != null">
				MODIFY_USER_IDENTITY =
				#{record.modifyUserIdentity,jdbcType=SMALLINT},
			</if>
			<if test="record.modifyTime != null">
				MODIFY_TIME = #{record.modifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="record.deleteFlg != null">
				DELETE_FLG = #{record.deleteFlg,jdbcType=SMALLINT},
			</if>
			<if test="record.version != null">
				VERSION = #{record.version,jdbcType=INTEGER},
			</if>
		</set>
		<if test="_parameter != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByExample" parameterType="map">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		update agt_usr_comp_log_info
		set ID = #{record.id,jdbcType=VARCHAR},
		PINDEX = #{record.pindex,jdbcType=INTEGER},
		EID =
		#{record.eid,jdbcType=VARCHAR},
		USER_ID =
		#{record.userId,jdbcType=VARCHAR},
		PID =
		#{record.pid,jdbcType=VARCHAR},
		OFFICE_ID =
		#{record.officeId,jdbcType=VARCHAR},
		COMPANY_ID =
		#{record.companyId,jdbcType=VARCHAR},
		REJECT_REASON =
		#{record.rejectReason,jdbcType=VARCHAR},
		STATUS =
		#{record.status,jdbcType=INTEGER},
		CREATE_USER =
		#{record.createUser,jdbcType=VARCHAR},
		CREATE_USER_IDENTITY =
		#{record.createUserIdentity,jdbcType=SMALLINT},
		CREATE_TIME =
		#{record.createTime,jdbcType=TIMESTAMP},
		MODIFY_USER =
		#{record.modifyUser,jdbcType=VARCHAR},
		MODIFY_USER_IDENTITY =
		#{record.modifyUserIdentity,jdbcType=SMALLINT},
		MODIFY_TIME =
		#{record.modifyTime,jdbcType=TIMESTAMP},
		DELETE_FLG =
		#{record.deleteFlg,jdbcType=SMALLINT},
		VERSION =
		#{record.version,jdbcType=INTEGER}
		<if test="_parameter != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByPrimaryKeySelective" parameterType="com.dlfc.zfgj.entity.AgtUsrCompLogInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		update agt_usr_comp_log_info
		<set>
			<if test="pindex != null">
				PINDEX = #{pindex,jdbcType=INTEGER},
			</if>
			<if test="eid != null">
				EID = #{eid,jdbcType=VARCHAR},
			</if>
			<if test="userId != null">
				USER_ID = #{userId,jdbcType=VARCHAR},
			</if>
			<if test="pid != null">
				PID = #{pid,jdbcType=VARCHAR},
			</if>
			<if test="officeId != null">
				OFFICE_ID = #{officeId,jdbcType=VARCHAR},
			</if>
			<if test="companyId != null">
				COMPANY_ID = #{companyId,jdbcType=VARCHAR},
			</if>
			<if test="rejectReason != null">
				REJECT_REASON = #{rejectReason,jdbcType=VARCHAR},
			</if>
			<if test="status != null">
				STATUS = #{status,jdbcType=INTEGER},
			</if>
			<if test="createUser != null">
				CREATE_USER = #{createUser,jdbcType=VARCHAR},
			</if>
			<if test="createUserIdentity != null">
				CREATE_USER_IDENTITY =
				#{createUserIdentity,jdbcType=SMALLINT},
			</if>
			<if test="createTime != null">
				CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="modifyUser != null">
				MODIFY_USER = #{modifyUser,jdbcType=VARCHAR},
			</if>
			<if test="modifyUserIdentity != null">
				MODIFY_USER_IDENTITY =
				#{modifyUserIdentity,jdbcType=SMALLINT},
			</if>
			<if test="modifyTime != null">
				MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="deleteFlg != null">
				DELETE_FLG = #{deleteFlg,jdbcType=SMALLINT},
			</if>
			<if test="version != null">
				VERSION = #{version,jdbcType=INTEGER},
			</if>
		</set>
		where ID = #{id,jdbcType=VARCHAR}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.dlfc.zfgj.entity.AgtUsrCompLogInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Nov 20 
			11:42:44 CST 2015. -->
		update agt_usr_comp_log_info
		set PINDEX = #{pindex,jdbcType=INTEGER},
		EID = #{eid,jdbcType=VARCHAR},
		USER_ID = #{userId,jdbcType=VARCHAR},
		PID = #{pid,jdbcType=VARCHAR},
		OFFICE_ID =
		#{officeId,jdbcType=VARCHAR},
		COMPANY_ID =
		#{companyId,jdbcType=VARCHAR},
		REJECT_REASON =
		#{rejectReason,jdbcType=VARCHAR},
		STATUS = #{status,jdbcType=INTEGER},
		CREATE_USER = #{createUser,jdbcType=VARCHAR},
		CREATE_USER_IDENTITY =
		#{createUserIdentity,jdbcType=SMALLINT},
		CREATE_TIME =
		#{createTime,jdbcType=TIMESTAMP},
		MODIFY_USER =
		#{modifyUser,jdbcType=VARCHAR},
		MODIFY_USER_IDENTITY =
		#{modifyUserIdentity,jdbcType=SMALLINT},
		MODIFY_TIME =
		#{modifyTime,jdbcType=TIMESTAMP},
		DELETE_FLG =
		#{deleteFlg,jdbcType=SMALLINT},
		VERSION = #{version,jdbcType=INTEGER}
		where ID = #{id,jdbcType=VARCHAR}
	</update>

	<resultMap id="AgtUsrCompLogInfoResultMap" type="com.dlfc.zfgj.entity.AgtUsrCompLogInfo">
		<id column="ID" jdbcType="VARCHAR" property="id" />
		<result column="PINDEX" jdbcType="INTEGER" property="pindex" />
		<result column="EID" jdbcType="VARCHAR" property="eid" />
		<result column="PID" jdbcType="VARCHAR" property="pid" />
		<result column="USER_ID" jdbcType="VARCHAR" property="userId" />
		<result column="OFFICE_ID" jdbcType="VARCHAR" property="officeId" />
		<result column="COMPANY_ID" jdbcType="VARCHAR" property="companyId" />
		<result column="REJECT_REASON" jdbcType="VARCHAR" property="rejectReason" />
		<result column="STATUS" jdbcType="INTEGER" property="status" />
		<result column="CREATE_USER" jdbcType="VARCHAR" property="createUser" />
		<result column="CREATE_USER_IDENTITY" jdbcType="SMALLINT"
			property="createUserIdentity" />
		<result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
		<result column="MODIFY_USER" jdbcType="VARCHAR" property="modifyUser" />
		<result column="MODIFY_USER_IDENTITY" jdbcType="SMALLINT"
			property="modifyUserIdentity" />
		<result column="MODIFY_TIME" jdbcType="TIMESTAMP" property="modifyTime" />
		<result column="DELETE_FLG" jdbcType="SMALLINT" property="deleteFlg" />
		<result column="VERSION" jdbcType="INTEGER" property="version" />
		<association column="PID" property="sysPerson"
			select="com.dlfc.zfgj.mapper.SysPersonMapper.selectByPrimaryKey" />
		<association column="USER_ID" property="usrUser"
			select="com.dlfc.zfgj.mapper.UsrUserMapper.selectByPrimaryKey" />
		<association column="OFFICE_ID" property="sysOffice"
			select="com.dlfc.zfgj.mapper.SysOfficeMapper.selectByPrimaryKey" />
		<association column="{USER_ID=USER_ID}" property="agtCertLink"
			select="com.dlfc.zfgj.mapper.AgtCertLinkMapper.selectByMap" />
		<association column="{OFFICE_ID=OFFICE_ID}" property="agtCompInfo"
			select="com.dlfc.zfgj.mapper.AgtCompInfoMapper.selectCompByOffice" />
		<!-- <association column="{NAME=NAME}" property="sysPerson" -->
		<!-- select="com.dlfc.zfgj.mapper.SysPersonMapper.selectByMap" /> -->
		<!-- <association column="{ID_NO=ID_NO}" property="sysPerson" -->
		<!-- select="com.dlfc.zfgj.mapper.SysPersonMapper.selectByMap" /> -->
		<!-- <association column="{MOBILE=MOBILE}" property="usrUser" -->
		<!-- select="com.dlfc.zfgj.mapper.SysPersonMapper.selectByMap" /> -->
		<!-- <association column="{CERT_CARD_NO=CERT_CARD_NO}" property="agtCertLink" -->
		<!-- select="com.dlfc.zfgj.mapper.SysPersonMapper.selectByMap" /> -->
	</resultMap>

	<select id="selectByExampleAll" parameterType="com.dlfc.zfgj.entity.AgtUsrCompLogInfoExample"
		resultMap="AgtUsrCompLogInfoResultMap">
		SELECT
		<include refid="Base_Column_List" />
		FROM AGT_USR_COMP_LOG_INFO
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
		<if test="orderByClause != null">
			order by ${orderByClause}
		</if>
	</select>
    <select id="selectAgtUsrCompLogCount" resultType="int">
        SELECT
        COUNT(1)
        FROM
        agt_usr_comp_log_info A
        LEFT JOIN SYS_PERSON P ON A.PID = P.ID
        LEFT JOIN USR_USER U ON
        A.USER_ID = U.ID
        LEFT JOIN agt_cert_link C ON A.USER_ID = C.USER_ID
        WHERE
        A.STATUS = #{status} AND A.OFFICE_ID = #{companyId} AND A.DELETE_FLG = 0
        <if test="pid != null">
            AND (
            P.`NAME` LIKE '%${pid}%'
            OR U.MOBILE LIKE '%${pid}%'
            OR P.ID_NO LIKE '%${pid}%'
            OR C.CERT_CARD_NO LIKE '%${pid}%'
            )
        </if>
    </select>
	<!-- add by yuanjiwei 2015.11.20 -->
	<select id="selectAgtUsrCompLogList" resultType="com.dlfc.zfgj.entity.AgtUsrCompLogInfo">
		SELECT
		A.ID AS ID,
		P.`NAME` AS `sysPerson.NAME`,
		U.`MOBILE` AS `usrUser.MOBILE`,
		A.`CREATE_TIME` AS CREATETIME,
		P.`ID_NO` AS `sysPerson.IDNO`,
		C.`CERT_CARD_NO` AS `agtCertLink.CERTCARDNO`,
		(select s.file_path from  sys_info_att s where s.lid=C.id limit 1 ) fImg,
		(select s.file_path from  sys_info_att s where s.lid=C.id limit 1,1 ) sImg
		FROM
		agt_usr_comp_log_info A
		LEFT JOIN SYS_PERSON P ON A.PID = P.ID
		LEFT JOIN USR_USER U ON
		A.USER_ID = U.ID
		LEFT JOIN agt_cert_link C ON A.USER_ID = C.USER_ID
		WHERE
		A.STATUS = #{status} AND A.OFFICE_ID = #{companyId} AND A.DELETE_FLG = 0
		<if test="pid != null">
			AND (
			P.`NAME` LIKE '%${pid}%'
			OR U.MOBILE LIKE '%${pid}%'
			OR P.ID_NO LIKE '%${pid}%'
			OR C.CERT_CARD_NO LIKE '%${pid}%'
			)
		</if>
		order by a.create_time DESC

	</select>
	
	  <!-- 通过userid和公司id查id -->
	<select id="selectIdByUserId" resultType="String">
		SELECT
		ID
		FROM AGT_USR_COMP_LOG_INFO
		WHERE USER_ID=#{userId} AND DELETE_FLG = 0
	</select>

  <!-- 取消申请加入公司 -->
	<select id="reJoinComp">
		UPDATE AGT_USR_COMP_LOG_INFO a
INNER JOIN(
SELECT
			MAX(PINDEX) PINDEX
		FROM
			AGT_USR_COMP_LOG_INFO
		WHERE
			USER_ID = #{value} AND DELETE_FLG = 0 AND STATUS = 0
) c
on a.PINDEX = c.PINDEX
SET a. STATUS = 3
	

	</select>
	
	<select id="findAgtUsrCompLog" resultType="com.dlfc.zfgj.entity.AgtUsrCompLogInfo" parameterType="String">
		SELECT 
		<include refid="Base_Column_List" />
		FROM AGT_USR_COMP_LOG_INFO
		WHERE USER_ID=#{value} AND DELETE_FLG = 0 ORDER BY PINDEX DESC LIMIT 1
	</select>
</mapper>